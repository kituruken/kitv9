# The scripted effects here do not appear in the vanilla EU4 files.
# Not all of them are utilized but some are utilized in missions or in other scripted effects inside of those here
# For mod stability sake just leave them here

add_ship_construction_scaled_to_ports_MAY = {	
	random_owned_province = {
		limit = {
			has_port = yes
		}
		if = {
			limit = {
				owner = {
					num_of_ports = 10
				}
			}
			add_unit_construction = {
				amount = 10
				type = heavy_ship
				speed = 0.5
				cost = 0
			}
		}
		else_if = {
			limit = {
				owner = {
					num_of_ports = 8
				}
			}
			add_unit_construction = {
				amount = 8
				type = heavy_ship
				speed = 0.5
				cost = 0
			}
		}
		else_if = {
			limit = {
				owner = {
					num_of_ports = 6
				}
			}
			add_unit_construction = {
				amount = 6
				type = heavy_ship
				speed = 0.5
				cost = 0
			}
		}
		else_if = {
			limit = {
				owner = {
					num_of_ports = 4
				}
			}
			add_unit_construction = {
				amount = 4
				type = heavy_ship
				speed = 0.5
				cost = 0
			}
		}
		else = {
			add_unit_construction = {
				amount = 2
				type = heavy_ship
				speed = 0.5
				cost = 0
			}
		}
	}
}

austria_iberian_hegemony_reward = {
    custom_tooltip = HAB_CREATE_INTEGRATED_PU_IN_IBERIA
    hidden_effect = {
        if = {
            limit = {
                senior_union_with = CAS
            }
            create_subject = {
                subject_type = integrated_personal_union
                subject = CAS
            }
        }
        if = {
            limit = {
                senior_union_with = SPA
            }
            create_subject = {
                subject_type = integrated_personal_union
                subject = SPA
            }
        }
    }
}

austria_surpass_poland_effect = {
    custom_tooltip = HAB_GIVE_RESTORATION_OF_UNION
    hidden_effect = {
        if = {
            limit = {
                exists = PLC
                PLC = { valid_for_personal_unions_trigger = yes }
                valid_for_personal_unions_trigger = yes
                PLC = { NOT = { total_own_and_non_tributary_subject_development = 400 } }
            }
            add_casus_belli = {
                type = cb_restore_personal_union
                target = PLC
            }
        }
        if = {
            limit = {
                exists = POL
                POL = { valid_for_personal_unions_trigger = yes }
                valid_for_personal_unions_trigger = yes
                POL = { NOT = { total_own_and_non_tributary_subject_development = 400 } }
            }
            add_casus_belli = {
                type = cb_restore_personal_union
                target = POL
            }
        }
    }
}

austria_king_of_poland_effect_2 = {
    add_accepted_culture_or_dip_power = { culture = polish dip_reward = yes }

    custom_tooltip = SEPERATOR_TOOLTIP
	tooltip = {
		country_event_with_option_insight = {
			id = flavor_hab.31
			option_1 = "
				262 = {
					add_base_production = 3
					add_province_modifier = {
						name = hab_expansion_of_krakow
						duration = -1
					}
				}
			"
			option_2 = "
				257 = {
					add_base_manpower = 2
					add_province_modifier = {
						name = hab_conscription_in_warsaw
						duration = -1
					}
				}
			"
		}
	}
}

boh_integrate_silesian_subjects = {
    if = {
        limit = {
            GLG = {
                ai = yes
                is_subject_of = BOH
                NOT = {
                    num_of_cities = 10
                }
            }
        }
        BOH = {
            inherit = GLG
        }
    }
    if = {
        limit = {
            OPL = {
                ai = yes
                is_subject_of = BOH
                NOT = {
                    num_of_cities = 10
                }
            }
        }
        BOH = {
            inherit = OPL
        }
    }
    if = {
        limit = {
            SIL = {
                ai = yes
                is_subject_of = BOH
                NOT = {
                    num_of_cities = 10
                }
            }
        }
        BOH = {
            inherit = SIL
        }
    }
}

create_general_scaling_with_tradition_and_pips = {
	if = {
		limit = {
			army_tradition = 80
		}
		create_general_with_pips = {
			tradition = 100
			[[add_fire] add_fire = $add_fire$ ]
			[[add_shock] add_shock = $add_shock$ ]
			[[add_manuever] add_manuever = $add_manuever$ ]
			[[add_siege] add_siege = $add_siege$ ]
		}
	}
	else_if = {
		limit = {
			army_tradition = 70
		}
		create_general_with_pips = {
			tradition = 90
			[[add_fire] add_fire = $add_fire$ ]
			[[add_shock] add_shock = $add_shock$ ]
			[[add_manuever] add_manuever = $add_manuever$ ]
			[[add_siege] add_siege = $add_siege$ ]
		}
	}
	else_if = {
		limit = {
			army_tradition = 60
		}
		create_general_with_pips = {
			tradition = 80
			[[add_fire] add_fire = $add_fire$ ]
			[[add_shock] add_shock = $add_shock$ ]
			[[add_manuever] add_manuever = $add_manuever$ ]
			[[add_siege] add_siege = $add_siege$ ]
		}
	}
	else_if = {
		limit = {
			army_tradition = 50
		}
		create_general_with_pips = {
			tradition = 70
			[[add_fire] add_fire = $add_fire$ ]
			[[add_shock] add_shock = $add_shock$ ]
			[[add_manuever] add_manuever = $add_manuever$ ]
			[[add_siege] add_siege = $add_siege$ ]
		}
	}
	else_if = {
		limit = {
			army_tradition = 40
		}
		create_general_with_pips = {
			tradition = 60
			[[add_fire] add_fire = $add_fire$ ]
			[[add_shock] add_shock = $add_shock$ ]
			[[add_manuever] add_manuever = $add_manuever$ ]
			[[add_siege] add_siege = $add_siege$ ]
		}
	}
	else_if = {
		limit = {
			army_tradition = 30
		}
		create_general_with_pips = {
			tradition = 50
			[[add_fire] add_fire = $add_fire$ ]
			[[add_shock] add_shock = $add_shock$ ]
			[[add_manuever] add_manuever = $add_manuever$ ]
			[[add_siege] add_siege = $add_siege$ ]
		}
	}
	else = {
		create_general_with_pips = {
			tradition = 40
			[[add_fire] add_fire = $add_fire$ ]
			[[add_shock] add_shock = $add_shock$ ]
			[[add_manuever] add_manuever = $add_manuever$ ]
			[[add_siege] add_siege = $add_siege$ ]
		}
	}
	custom_tooltip = create_leader_scaling_with_tradition_tt
}

distribute_development = {
	hidden_effect = {
		set_variable = {
			which = $type$_loop
			value = 0
		}
		while = {
			limit = {
				NOT = {
					check_variable = {
						which = $type$_loop
						value = $amount$
					}
				}
			}
			random_owned_province = {
				[[limit]
					limit = {
						$limit$
					} 
				]
				add_base_$type$ = 1
			}
			change_variable = {
				which = $type$_loop
				value = 1
			}
		}
	}
	custom_tooltip = $type$_$amount$
	custom_tooltip = " "
	[[tooltip]
		custom_tooltip = $tooltip$
		custom_tooltip = " "
	]
}

every_trunk_road_province_effect = {
	custom_tooltip = MUG_every_highlighted_province
	tooltip = {
		$effect$
	}
	hidden_effect = {
		4449 = { $effect$ }
		2076 = { $effect$ }
		507 = { $effect$ }
		2075 = { $effect$ }
		510 = { $effect$ }
		2062 = { $effect$ }
		522 = { $effect$ }
		524 = { $effect$ }
		2063 = { $effect$ }
		523 = { $effect$ }
		555 = { $effect$ }
		4490 = { $effect$ }
		4487 = { $effect$ }
		4489 = { $effect$ }
		2044 = { $effect$ }
		563 = { $effect$ }
		4479 = { $effect$ }
		4476 = { $effect$ }
		561 = { $effect$ }
		4475 = { $effect$ }
	}
}

extra_claims_for_nomadic_path = {
	if = {
		limit = {
			TIM_nomad_tree_trigger = yes
		}
		if = {
			limit = {
				not_in_mission_preview_mode = { key = TIM }
			}
			$effect$ 
		}
		else = {
			custom_tooltip = TIM_if_we_choose_to_go_for_nomadic_tree
			tooltip = {
				$effect$
			}
		}
		custom_tooltip = " "
	}
}

feo_create_general_diplomatic_action_effect = {
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 0
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 20
                }
            }
        }
        create_general = { tradition = 10 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 20
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 30
                }
            }
        }
        create_general = { tradition = 20 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 30
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 40
                }
            }
        }
        create_general = { tradition = 30 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 40
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 50
                }
            }
        }
        create_general = { tradition = 40 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 50
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 60
                }
            }
        }
        create_general = { tradition = 50 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 60
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 70
                }
            }
        }
        create_general = { tradition = 60 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 70
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 80
                }
            }
        }
        create_general = { tradition = 70 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 80
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 90
                }
            }
        }
        create_general = { tradition = 80 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 90
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 100
                }
            }
        }
        create_general = { tradition = 90 }
    }
    if = {
        limit = {
            check_variable = {
                which = ArmyTradtionOfFROM
                value = 100
            }
            NOT = {
                check_variable = {
                    which = ArmyTradtionOfFROM
                    value = 110
                }
            }
        }
        create_general = { tradition = 100 }
    }
}

feo_aegean_supremacy_aegean_islands_reward = {
	4700 = {
		add_province_modifier = {
			name = feo_aegean_trading_outpost
			duration = -1
		}
	}
	2348 = {
		add_province_modifier = {
			name = feo_aegean_trading_outpost
			duration = -1
		}
	}
	164 = {
		add_province_modifier = {
			name = feo_aegean_trading_outpost
			duration = -1
		}
	}
	3003 = {
		add_province_modifier = {
			name = feo_aegean_trading_outpost
			duration = -1
		}
	}
	320 = {
		add_province_modifier = {
			name = feo_aegean_trading_outpost
			duration = -1
		}
	}
	163 = {
		add_province_modifier = {
			name = feo_aegean_trading_outpost
			duration = -1
		}
	}
}

feo_aegean_supremacy_coastal_fortifications_reward = {
	every_owned_province = {
		limit = {
			OR = {
				province_id = 4705
				province_id = 148
				province_id = 147
				province_id = 146
				province_id = 3003
				province_id = 4701
				province_id = 145
				province_id = 164
			}
			development = 15
			has_coast_defense_building_trigger = yes
		}
		add_or_upgrade_naval_defense_building = yes
	}
	every_owned_province = {
		limit = {
			OR = {
				province_id = 4705
				province_id = 148
				province_id = 147
				province_id = 146
				province_id = 3003
				province_id = 4701
				province_id = 145
				province_id = 164
			}
		}
		add_province_modifier = {
			name = feo_aegean_slave_raid_block
			duration = -1
			hidden = yes
		}
	}
}


feo_conflicts_in_lithuania_event_opt_1 = {
	random_owned_province = {
		limit = {
			region = ruthenia_region
		}
		change_culture = crimean
	}
	random_owned_province = {
		limit = {
			region = ruthenia_region
		}
		change_culture = crimean
	}
	random_owned_province = {
		limit = {
			region = ruthenia_region
		}
		change_culture = crimean
	}
	random_owned_province = {
		limit = {
			region = ruthenia_region
		}
		change_culture = crimean
	}
	if = {
		limit = {
			has_dlc = "The Cossacks"
		}
		add_estate_loyalty_modifier = {
			estate = estate_cossacks
			desc = EST_COSSACK_GRANTED_RUTHENIAN_LAND
			loyalty = 10
			duration = -1
		}
		custom_tooltip = FEO_MODIFY_COSSACK_SELF_GOVERNANCE_IN_RUTHENIA
		set_country_flag = feo_cossack_self_governance_ruthenia_buff
		hidden_effect = {
			if = {
				limit = {
					has_estate_privilege = estate_cossacks_cossack_self_governance
				}
				every_owned_province = {
					limit = {
						region = ruthenia_region
					}
					add_province_modifier = {
						name = feo_cossack_self_governance_ruthenia
						duration = -1
					}
				}
			}
		}
	}
	else = {
		custom_tooltip = FEO_ALL_RUTHENIAN_PROVINCES_GAIN_PERMANENT_MODIFIER
		custom_tooltip = " "
		add_country_modifier = {
			name = feo_plains_of_ruthenia
			duration = 7300
		}
		hidden_effect = {
			every_owned_province = {
				limit = {
					region = ruthenia_region
					culture_group = tartar
				}
				add_province_modifier = {
					name = feo_tatar_population
					duration = -1
				}
			}
		}
	}
}

feo_conflicts_in_lithuania_event_opt_2 = {
	
	custom_tooltip = FEO_DISTRIBUTED_ONLY_IN_RUTHENIA
	hidden_effect = {
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
		random_owned_province = {
			limit = { region = ruthenia_region }
			add_base_manpower = 1
		}
	}
	custom_tooltip = FEO_4_RANDOM_RUTHENIAN_PROVINCES_GAIN_MANU
	hidden_effect = {
		random_owned_province = {
			limit = {
				region = ruthenia_region
				NOT = {
					has_manufactory_trigger = yes
				}
			}
			add_manufactory = yes
		}
		random_owned_province = {
			limit = {
				region = ruthenia_region
				NOT = {
					has_manufactory_trigger = yes
				}
			}
			add_manufactory = yes
		}
		random_owned_province = {
			limit = {
				region = ruthenia_region
				NOT = {
					has_manufactory_trigger = yes
				}
			}
			add_manufactory = yes
		}
		random_owned_province = {
			limit = {
				region = ruthenia_region
				NOT = {
					has_manufactory_trigger = yes
				}
			}
			add_manufactory = yes
		}
	}
}

feo_integrate_cossacks_event_opt_1 = {
	if = {
		limit = {
			has_dlc = "The Cossacks"
		}
		set_country_flag = feo_expand_cossack_regiments_buff_flag
		custom_tooltip = FEO_GRANT_COSSACK_FL_FOR_EXPAND_COSSACK_REGIMENTS
		custom_tooltip = " "
		add_country_modifier = {
			name = feo_elite_tatar_vanguard
			duration = -1
		}
	}
	else = {
		unlock_merc_company = {
			merc_company = merc_tatar_vanguard
			free_merc = yes
		}
	}
}

feo_integrate_cossacks_event_opt_2 = {
	if = {
		limit = {
			has_dlc = "The Cossacks"
		}
		custom_tooltip = FEO_GRANT_COSSACK_SELF_GOVERNANCE_BUFF
		set_country_flag = feo_cossack_self_governance_buff_flag
		
		hidden_effect = {
			if = {
				limit = {
					has_estate_privilege = estate_cossacks_cossack_self_governance
				}
				every_owned_province = {
					limit = {
						has_terrain = steppe
					}
					add_province_modifier = {
						name = feo_cossack_self_governance_religious_buff
						duration = -1
					}
				}
			}
		}
	}
	else = {
		add_country_modifier = {
			name = feo_cosssack_autonomy_modifier
			duration = -1
		}
	}
}

feo_russian_aristocracy_army_size_effect = {
	if = {
		limit = {
			any_country = {
				NOT = { tag = ROOT }
				capital_scope = {
					region = russia_region
				}
			}
		}
		pick_best_tags = {
			global_trigger = "
				NOT = { tag = ROOT }
				capital_scope = {
					region = russia_region
				}
				government = monarchy
			"
			scale = total_development
			1 = yes
			event_target_name = russian_pu_tag
		}
		hidden_effect = {
			event_target:russian_pu_tag_1 = {
				save_global_event_target_as = feo_russian_pu
				set_country_flag = feo_russian_pu
			}
			country_event = { id = flavor_feo.8 }
		}
	}
	else = {
		give_claims = { region = russia_region }
	}
}

feo_russian_claims_reward_effect = {
	custom_tooltip = FEO_LOWER_RUSSIAN_PROVINCES_AUTONOMY_AND_ACCEPT_RUSSIAN_CULTURE
	hidden_effect = {
		every_owned_province = {
			limit = {
				region = russia_region
			}
			add_local_autonomy = -20
			add_nationalism = -20
		}
		set_country_flag = feo_russian_accepted_cultures_flag
		add_country_modifier = {
			name = feo_russian_tolerance
			duration = -1
			hidden = yes
		}
		add_accepted_culture = russian
		add_accepted_culture = novgorodian
		add_accepted_culture = ryazanian
		add_accepted_culture = byelorussian
		add_accepted_culture = ruthenian
	}
}

flavor_ger_4_option_1_effect = {
	
	custom_tooltip = GER_one_province_gets_converted
					
	custom_tooltip = " "
	
	if = {
		limit = {
			NOT = { religion = catholic }
		}
		add_country_modifier = {
			name = GER_fight_against_the_catholic_church
			duration = -1
		}
	}
	else = {
		add_country_modifier = {
			name = GER_stopping_polish_independence_drive
			duration = -1
		}
	}
	
	custom_tooltip = GER_every_polish_province_loses_20_autonomy
}

GER_cultural_unity_integrated = {
	GER_execute_effect_for_every_culture = {
		effect = GER_cultural_unity_integrated_specific
	}
	
	hidden_effect = {
		GER_clear_integration_flag = yes
		regenerate_government_mechanics = yes
		
		set_government_power = {
			mechanic_type = cultural_unity_mechanic
			power_type = cultural_unity
			value = 0
		}
	}
}

GER_cultural_unity_integrated_specific = {
	if = {
		limit = {
			has_country_flag = GER_integrating_$culture$
		}
		set_country_flag = GER_integrated_$culture$
		GER_integrated_culture = { culture = $culture$ }
	}
}

GER_integrated_culture = {
	if = {
		limit = {
			accepted_culture = $culture$
		}
		add_country_modifier = {
			name = GER_$culture$_modifier
			duration = -1
			desc = GER_until_demotion
		}
	}
	else = {
		add_country_modifier = {
			name = GER_$culture$_modifier
			duration = -1
			desc = GER_until_demotion
		}
		add_accepted_culture = $culture$
	}
}

GER_on_culture_promoted = {
	GER_execute_effect_for_every_culture = {
		effect = GER_on_specific_culture_promoted
	}
}

GER_on_specific_culture_promoted = {
	if = {
		limit = {
			accepted_culture = $culture$
			has_country_flag = GER_integrated_$culture$
			NOT = { has_country_modifier = GER_$culture$_modifier }
		}
		add_country_modifier = {
			name = GER_$culture$_modifier
			duration = -1
			desc = GER_until_demotion
		}
	}
}

GER_on_culture_demoted = {
	GER_execute_effect_for_every_culture = {
		effect = GER_on_specific_culture_demoted
	}
}

GER_on_specific_culture_demoted = {
	if = {
		limit = {
			OR = {
				NOT = { has_country_flag = GER_integrated_$culture$ }
				NOT = { accepted_culture = $culture$ }
			}
			has_country_modifier = GER_$culture$_modifier
		}
		remove_country_modifier = GER_$culture$_modifier
	}
}

GER_clear_integration_flag = {
	GER_execute_effect_for_every_culture = {
		effect = GER_clear_flag
	}
}

GER_execute_effect_for_every_culture = {
	$effect$ = { culture = pommeranian }
	$effect$ = { culture = austrian }
	$effect$ = { culture = bavarian }
	$effect$ = { culture = swiss }
	$effect$ = { culture = swabian }
	$effect$ = { culture = franconian }
	$effect$ = { culture = saxon }
	$effect$ = { culture = hessian }
	$effect$ = { culture = hannoverian }
	$effect$ = { culture = lower_saxon }
	$effect$ = { culture = prussian }
}

GER_start_integrating = {
	hidden_effect = {
		GER_clear_integration_flag = yes
	}
	
	custom_tooltip = GER_begin_integrating
	
	set_country_flag = GER_integrating_$culture$
	
	hidden_effect = {
		regenerate_government_mechanics = yes
		unfreeze_government_power = {
			mechanic_type = cultural_unity_mechanic
			power_type = cultural_unity
		}
	}
}

GER_clear_flag = {
	clr_country_flag = GER_integrating_$culture$
}

GER_unlock_reform_based_on_culture = {
	if = {
		limit = {
			OR = {
				primary_culture = lower_saxon
				primary_culture = baltic_german
				primary_culture = pommeranian
			}
		}
		GER_unlock_reform_based_on_certain_culture = { culture = lower_saxon [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = prussian
		}
		GER_unlock_reform_based_on_certain_culture = { culture = prussian [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = hannoverian
		}
		GER_unlock_reform_based_on_certain_culture = { culture = westphalian [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = hessian
		}
		GER_unlock_reform_based_on_certain_culture = { culture = rhenish [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = saxon
		}
		GER_unlock_reform_based_on_certain_culture = { culture = saxon [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = franconian
		}
		GER_unlock_reform_based_on_certain_culture = { culture = franconian [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = swabian
		}
		GER_unlock_reform_based_on_certain_culture = { culture = swabian [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = swiss
		}
		GER_unlock_reform_based_on_certain_culture = { culture = swiss [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = bavarian
		}
		GER_unlock_reform_based_on_certain_culture = { culture = bavarian [[reform] reform = $reform$ ] }
	}
	else_if = {
		limit = {
			primary_culture = austrian
		}
		GER_unlock_reform_based_on_certain_culture = { culture = austrian [[reform] reform = $reform$ ] }
	}
	else = {
		GER_unlock_reform_based_on_certain_culture = { culture = other [[reform] reform = $reform$ ] }
	}
}

GER_unlock_reform_based_on_certain_culture = {
	set_country_flag = GER_unlocked_$culture$_reform
	[[reform]
		add_government_reform = german_$culture$_reform
	]
}

GER_remove_cultural_disunity_modifier_for_culture = {
	if = {
		limit = {
			has_country_modifier = GER_$culture$_modifier
		}
		remove_country_modifier = GER_$culture$_modifier
	}
}

GER_remove_cultural_disunity_modifiers = {
	GER_execute_effect_for_every_culture = {
		effect = GER_remove_cultural_disunity_modifier_for_culture
	}
}

give_area_claims = {
	$group$ = {
		limit = {
			NOT = { is_core = $tag$ }
			NOT = { is_permanent_claim = $tag$ }
		}
		add_permanent_claim = $tag$
	}
}

give_province_claims = {
	$id$ = {
		if = {
			limit = {
				NOT = { is_core = $tag$ }
				NOT = { is_permanent_claim = $tag$ }
			}
			add_permanent_claim = $tag$
		}
	}
}

grant_estate_10_crown_land = {
	change_estate_land_share = {
		estate = all
		share = -20
	}
	change_estate_land_share = {
		estate = estate_$estate$
		share = 10
	}
}

hab_divide_france = {
	every_owned_province = {
		limit = {
			region = france_region
		}
		set_in_empire = yes
	}

	if = {
		limit = {
			NOT = {
				exists = DAU
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = DAU }
				remove_core = DAU
			}
		}
		savoy_dauphine_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = DAU
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		ROOT = { 
			release = DAU
		}
		
		DAU = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = BOU
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = BOU }
				remove_core = BOU
			}
		}
		massif_central_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = BOU
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		ROOT = { 
			release = BOU
		}
		
		BOU = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
    if = {
		limit = {
			NOT = {
				exists = LOR
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = LOR }
				remove_core = LOR
			}
		}
		lorraine_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = LOR
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		ROOT = { 
			release = LOR
		}
		
		LOR = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
    if = {
		limit = {
			NOT = {
				exists = PIC
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = PIC }
				remove_core = PIC
			}
		}

		picardy_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = PIC
				set_in_empire = yes
				remove_core = ROOT
			}
		}

		182 = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = PIC
				set_in_empire = yes
				remove_core = ROOT
			}
		}

		ROOT = { 
			release = PIC
		}
		
		PIC = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = CHP
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = CHP }
				remove_core = CHP
			}
		}
		champagne_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = CHP
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		185 = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = CHP
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		183 = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = CHP
				set_in_empire = yes
				remove_core = ROOT
			}
		}

		ROOT = { 
			release = CHP
		}
		
		CHP = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = NRM
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = NRM }
				remove_core = NRM
			}
		}
		normandy_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = NRM
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		4388 = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = NRM
				set_in_empire = yes
				remove_core = ROOT
			}
		}

		ROOT = { 
			release = NRM
		}
		
		NRM = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = BRI
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = BRI }
				remove_core = BRI
			}
		}
		brittany_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = BRI
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		ROOT = { 
			release = BRI
		}
		
		BRI = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = ORL
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = ORL }
				remove_core = ORL
			}
		}
		orleans_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = ORL
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		loire_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = ORL
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		ROOT = { 
			release = ORL
		}
		
		ORL = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = PRO
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = PRO }
				remove_core = PRO
			}
		}
		provence_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = PRO
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		ROOT = { 
			release = PRO
		}
		
		PRO = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = TOU
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = TOU }
				remove_core = TOU
			}
		}
		languedoc_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = TOU
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		198 = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = TOU
				set_in_empire = yes
				remove_core = ROOT
			}
		}

		ROOT = { 
			release = TOU
		}
		
		TOU = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = GUY
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = GUY }
				remove_core = GUY
			}
		}
		guyenne_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = GUY
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		poitou_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = GUY
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		pyrenees_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = GUY
				set_in_empire = yes
				remove_core = ROOT
			}
		}
		
		ROOT = { 
			release = GUY
		}
		
		GUY = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
	
	if = {
		limit = {
			NOT = {
				exists = BUR
			}
		}
		every_owned_province = {
			if = {
				limit = { is_core = BUR }
				remove_core = BUR
			}
		}
		west_burgundy_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = BUR
				
				remove_core = ROOT
			}
		}
		bourgogne_area = {
			if = {
				limit = {
					owned_by = ROOT
				}
				add_core = BUR
				
				remove_core = ROOT
			}
		}
		
		ROOT = { 
			release = BUR
		}
		
		BUR = {
			set_startup_values = yes
			add_historical_friend = ROOT
			ROOT = { add_historical_friend = BUR }
		}
	}
}

hab_liberate_balkans_effect = {
    custom_tooltip = HAB_CREATE_ROMANIA
    hidden_effect = {
        if = {
            limit = {
                WAL = {
                    was_player = yes
                }
            }
            WAL = {
                inherit = MOL
                change_tag = RMN
            }
        }
        else = {
            MOL = {
                inherit = WAL
                change_tag = RMN
            }
        }
    }
}

INC_upgrade_pachakuti = {
	if = {
		limit = {
			OR = {
				has_ruler_flag = CSU_pachakuti_upgrades_flag
				AND = {
					NOT = { mission_completed = CSU_ground_shaker }
					has_mission = CSU_ground_shaker
				}
			}
		}
		change_$type$ = 1
		custom_tooltip = CSU_only_for_this_ruler
		custom_tooltip = " "
	}
}

INC_upgrade_mountain_development_privilege = {
	custom_tooltip = INC_upgrade_mountain_development_privilege
	hidden_effect = {
		set_country_flag = INC_upgrade_mountain_development_privilege_flag
		if = {
			limit = {
				has_estate_privilege = estate_burghers_INC_mountain_development
			}
			every_owned_province = {
				limit = {
					has_terrain = mountain
				}
				remove_province_modifier = estate_burghers_mountain_expansion_mountains
				add_province_modifier = {
					name = estate_burghers_mountain_expansion_upgrade_mountains
					duration = -1
				}
			}
			every_owned_province = {
				limit = {
					has_terrain = hills
				}
				remove_province_modifier = estate_burghers_mountain_expansion_hills
				add_province_modifier = {
					name = estate_burghers_mountain_expansion_upgrade_hills
					duration = -1
				}
			}
			every_owned_province = {
				limit = {
					has_terrain = highlands
				}
				remove_province_modifier = estate_burghers_mountain_expansion_highlands
				add_province_modifier = {
					name = estate_burghers_mountain_expansion_upgrade_highlands
					duration = -1
				}
			}
		}
	}
}

INC_seize_crownland_modified_by_mummies = {
	if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 5
			}
		}
		change_estate_land_share = {
			estate = all
			share = -1.25
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 4
			}
		}
		change_estate_land_share = {
			estate = all
			share = -2.5
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 3
			}
		}
		change_estate_land_share = {
			estate = all
			share = -3.5
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 2
			}
		}
		change_estate_land_share = {
			estate = all
			share = -4.25
		}
	}
	else = {
		change_estate_land_share = {
			estate = all
			share = -4.75
		}
	}
}

INC_sell_crownland_modified_by_mummies = {
	if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 5
			}
		}
		if = {
			limit = { current_age = age_of_discovery }
			add_years_of_estate_land_income = 0.625
		}
		else_if = {
			limit = { current_age = age_of_reformation }
			add_years_of_estate_land_income = 0.5
		}
		else_if = {
			limit = { current_age = age_of_absolutism }
			add_years_of_estate_land_income = 0.375
		}
		else_if = {
			limit = { current_age = age_of_revolutions }
			add_years_of_estate_land_income = 0.25
		}
		else = {
			add_years_of_estate_land_income = 0.625
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 4
			}
		}
		if = {
			limit = { current_age = age_of_discovery }
			add_years_of_estate_land_income = 1.25
		}
		else_if = {
			limit = { current_age = age_of_reformation }
			add_years_of_estate_land_income = 1
		}
		else_if = {
			limit = { current_age = age_of_absolutism }
			add_years_of_estate_land_income = 0.75
		}
		else_if = {
			limit = { current_age = age_of_revolutions }
			add_years_of_estate_land_income = 0.5
		}
		else = {
			add_years_of_estate_land_income = 1.25
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 3
			}
		}
		if = {
			limit = { current_age = age_of_discovery }
			add_years_of_estate_land_income = 1.75
		}
		else_if = {
			limit = { current_age = age_of_reformation }
			add_years_of_estate_land_income = 1.4
		}
		else_if = {
			limit = { current_age = age_of_absolutism }
			add_years_of_estate_land_income = 1.05
		}
		else_if = {
			limit = { current_age = age_of_revolutions }
			add_years_of_estate_land_income = 0.7
		}
		else = {
			add_years_of_estate_land_income = 1.75
		}
	}
	else_if = {
		limit = {
			check_variable = {
				which = inca_amount_of_mummies
				value = 2
			}
		}
		if = {
			limit = { current_age = age_of_discovery }
			add_years_of_estate_land_income = 2.125
		}
		else_if = {
			limit = { current_age = age_of_reformation }
			add_years_of_estate_land_income = 1.7
		}
		else_if = {
			limit = { current_age = age_of_absolutism }
			add_years_of_estate_land_income = 1.275
		}
		else_if = {
			limit = { current_age = age_of_revolutions }
			add_years_of_estate_land_income = 0.85
		}
		else = {
			add_years_of_estate_land_income = 2.125
		}
	}
	else = {
		if = {
			limit = { current_age = age_of_discovery }
			add_years_of_estate_land_income = 2.375
		}
		else_if = {
			limit = { current_age = age_of_reformation }
			add_years_of_estate_land_income = 1.9
		}
		else_if = {
			limit = { current_age = age_of_absolutism }
			add_years_of_estate_land_income = 1.425
		}
		else_if = {
			limit = { current_age = age_of_revolutions }
			add_years_of_estate_land_income = 0.95
		}
		else = {
			add_years_of_estate_land_income = 2.125
		}
	}
}

ITA_branch_effect = {
	custom_tooltip = ITA_this_is_a_branching_mission
}

italian_ambitions_effect_1 = {
    country_event_with_option_insight = {
        id = flavor_hab.32
        option_1 = "
            custom_tooltip = HAB_GAIN_50_OPINION_WITH_ITALY
        "
        option_2 = "
            custom_tooltip = HAB_GAIN_SUBJECT_CB_ON_ITALY
        "
    }
}

MAY_pass_reform_1_effect = {
	add_country_modifier = {
		name = MAY_reform_evolving_modifier_1
		duration = -1
	}
}

MAY_pass_reform_2_effect = {
	custom_tooltip = MAY_reform_evolving_modifier_evolution
	hidden_effect = {
		remove_country_modifier = MAY_reform_evolving_modifier_1
		add_country_modifier = {
			name = MAY_reform_evolving_modifier_2
			duration = -1
		}
	}
}

MAY_pass_reform_3_effect = {
	custom_tooltip = MAY_reform_evolving_modifier_evolution
	hidden_effect = {
		remove_country_modifier = MAY_reform_evolving_modifier_2
		add_country_modifier = {
			name = MAY_reform_evolving_modifier_3
			duration = -1
		}
	}
}

MAY_pass_reform_4_effect = {
	custom_tooltip = MAY_reform_evolving_modifier_evolution
	hidden_effect = {
		remove_country_modifier = MAY_reform_evolving_modifier_3
		add_country_modifier = {
			name = MAY_reform_evolving_modifier_4
			duration = -1
		}
	}
}

MAY_pass_reform_5_effect = {
	custom_tooltip = MAY_reform_evolving_modifier_evolution
	hidden_effect = {
		remove_country_modifier = MAY_reform_evolving_modifier_4
		add_country_modifier = {
			name = MAY_reform_evolving_modifier_5
			duration = -1
		}
	}
}

MAY_venus_effect = {
	add_stability_or_adm_power = yes
	
	custom_tooltip = " "
	
	add_army_tradition_or_mil_power = { amount = 15 }
}

MAY_realm_size_effect = {
	add_yearly_manpower = 1
	
	custom_tooltip = " "
	
	add_power_projection = {
		type = MAY_reform_passed
		amount = 10
	}
	custom_tooltip = MAY_decays_1_yearly
}

ned_glorious_revolution_effect_opt_1_event_insight = {
	if = {
		limit = { has_dlc = "Domination" }
		custom_tooltip = NED_UNLOCK_MAN_O_WARS_TOOLTIP
	}
	else = {
		add_dip_power = 100
	}
}


ned_glorious_revolution_effect_opt_1 = {
	country_event_with_option_insight = {
		id = dutch_mission_events.3
		option_1 = "
			ned_glorious_revolution_effect_opt_1_event_insight = yes
			define_advisor = {
				type = naval_reformer
				skill = 3
				cost_multiplier = 0.25
				culture = english
			}
		"
		option_2 = "
			custom_tooltip = NED_ENGLAND_PU_IS_25_CHEAPER_TO_INTEGRATE
		"
	}
} 

on_age_ability_taken_age_of_discovery = { } #for future use (and modders!) :)
on_age_ability_taken_age_of_reformation = { }
on_age_ability_taken_age_of_absolutism = { }
on_age_ability_taken_age_of_revolutions = { }

on_age_ability_taken = {
	on_age_ability_taken_$age$ = yes
	
	if = {
		limit = {
			has_government_attribute = GER_taking_age_rewards_gives_stability
		}
		add_stability_or_adm_power = yes
	}
}

on_convert_by_trade_policy_effect = {
	FROM = { change_variable = { which = propogation_counter value = 1 } }
	if = {
		limit = {
			trade_company_region = trade_company_moluccas
			FROM = { is_defender_of_faith = yes }
		}
		FROM = {
			if = {
				limit = {
					ai = no
					NOT = { check_variable = { which = religion_propagated_in_moluccas value = 1 } }
				}
				set_variable = {
					which = religion_propagated_in_moluccas value = 1
				}
			}
			else_if = {
				limit = {
					ai = no
					check_variable = { which = religion_propagated_in_moluccas value = 1 }
					NOT = { check_variable = { which = religion_propagated_in_moluccas value = 6 } }
				}
				change_variable = {
					which = religion_propagated_in_moluccas value = 1
				}
			}
		}
	}
	if = {
		limit = { FROM = { has_country_flag = YEM_propagation_gives_navy_tradition } }
		FROM = { add_navy_tradition = 1 }
	}
	if = {
		limit = {
			FROM = { has_country_flag = orm_better_sea_religious_propagation }
			OR = {
				region = indonesia_region
				region = moluccas_region
				region = malaya_region
			}
		}
		FROM = { add_piety = 0.005 }
	}
	if = {
		limit = { FROM = { has_country_flag = hormuz_religious_propagations_buffs_flag } }
		add_province_modifier = {
			name = orm_hormuz_merchants_influence
			duration = 7300
		}
	}
}

orm_fars_event_opt_1 = {
    430 = {
        add_base_production = 1
		add_or_upgrade_shipyard_building = yes
    }
    4332 = {
        add_or_upgrade_shipyard_building = yes
    }
}

pick_best_tags = {
	[[scope]
		pick_best_tags_2 = {
			scope = $scope$
			scale = $scale$
			event_target_name = $event_target_name$
			global_trigger = "$global_trigger$"
			1 = "$1$"
			2 = "$2$"
			3 = "$3$"
			4 = "$4$"
			5 = "$5$"
			10 = "$10$"
		}
		set_global_flag = PICK_BEST_TAG_FLAG
	] #curses for not having an [ELSE ] or something.
	if = {
		limit = {
			NOT = { has_global_flag = PICK_BEST_TAG_FLAG } #This check is here to prevent the algorithm from being run again after the scoped version was executed
		}
		pick_best_tags_2 = {
			scope = every_country
			scale = $scale$
			event_target_name = $event_target_name$
			global_trigger = "$global_trigger$"
			1 = "$1$"
			2 = "$2$"
			3 = "$3$"
			4 = "$4$"
			5 = "$5$"
			10 = "$10$"
		}
	}
	else = { clr_global_flag = PICK_BEST_TAG_FLAG }
}

pick_best_tags_2 = {
	hidden_effect = {
		[[1]
			if = {
				limit = { always = $1$ }
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
			}
		]
		[[2]
			if = {
				limit = { always = $2$ }
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
			}
		]
		[[3]
			if = {
				limit = { always = $3$ }
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
			}
		]
		[[4]
			if = {
				limit = { always = $4$ }
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 4
				}
			}
		]
		[[5]
			if = {
				limit = { always = $5$ }
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 4
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 5
				}
			}
		]
		[[10]
			if = {
				limit = { always = $10$ }
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 1
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 2
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 3
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 4
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 5
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 6
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 7
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 8
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 9
				}
				pick_best_tag = {
					scale = "$scale$"
					scope = $scope$
					global_trigger = "$global_trigger$"
					event_target_name = "$event_target_name$"
					number = 10
				}
			}
		]
		$scope$ = {
			limit = {
				has_country_flag = $event_target_name$_exclude
			}
			clr_country_flag = $event_target_name$_exclude
		}
	}
}

pick_best_tag = {
	1 = { save_event_target_as = $event_target_name$_$number$ }
	$scope$ = {
		limit = {
			[[global_trigger] $global_trigger$ ]
			$scale$ = event_target:$event_target_name$_$number$
			NOT = { has_country_flag = $event_target_name$_exclude }
		}
		save_event_target_as = $event_target_name$_$number$
	}
	event_target:$event_target_name$_$number$ = {
		set_country_flag = $event_target_name$_exclude
	}
}

reform_civil_registration_effect = {
	custom_tooltip = YUA_EVERY_POPULATION_CENSUS_DECREE_GRANTS_MODIFIER
	if = {
		limit = { 
			has_dlc = "Rights of Man" 
			has_dlc = "Mandate of Heaven" 
			NOT = { num_of_ruler_traits = { amount = 3 } }
		}
		change_government_reform_progress = -150 
		add_ruler_personality = reformist_personality
		set_country_flag = mng_empowered_pop_census_flag 
	}
	else = { 
		change_adm = 1 
		change_government_reform_progress = -100 
		set_country_flag = mng_empowered_pop_census_flag 
	}
}

rus_clear_peasantry_estate_privileges = {
	if = {
		limit = { has_estate_privilege = estate_nobles_early_serfdom }
		remove_estate_privilege = estate_nobles_early_serfdom
	}
	if = {
		limit = { has_estate_privilege = estate_nobles_total_serfdom }
		remove_estate_privilege = estate_nobles_total_serfdom
	}
	if = {
		limit = { has_estate_privilege = estate_nobles_legalized_serfdom }
		remove_estate_privilege = estate_nobles_legalized_serfdom
	}
	if = {
		limit = { has_estate_privilege = estate_nobles_restricted_serfdom }
		remove_estate_privilege = estate_nobles_restricted_serfdom
	}
	if = {
		limit = { has_estate_privilege = estate_nobles_devastating_serfdom }
		remove_estate_privilege = estate_nobles_devastating_serfdom
	}
	if = {
		limit = { has_estate_privilege = estate_nobles_increased_peasant_freedom }
		remove_estate_privilege = estate_nobles_increased_peasant_freedom
	}
	if = {
		limit = { has_estate_privilege = estate_nobles_peasant_liberation }
		remove_estate_privilege = estate_nobles_peasant_liberation
	}
	if = {
		limit = { has_estate_privilege = estate_burghers_rise_of_the_burghers }
		remove_estate_privilege = estate_burghers_rise_of_the_burghers
	}
}

set_startup_values = {
	if = {
		limit = {
			capital_scope = {
				religion_group = christian
			}
		}
		change_religion = capital
	}
	capital_scope = {
		build_to_forcelimit = {
			infantry = 0.6
			cavalry = 0.3
			artillery = 0.1
		}
	}
	add_manpower = 20
	adopt_reform_progress = ROOT
	if = {
		limit = { 
			NOT = { prestige = -50 }
		}
		add_prestige = 100
	}
	add_adm_power = 500
	add_dip_power = 500
	add_mil_power = 500
	add_legitimacy = 100
	add_stability = 1
	add_treasury = 500
	change_estate_land_share = {
		estate = all
		share = 65
	}
}

update_fervor_effects = {
	if = {
		limit = { has_active_fervor = fervor_trade }
		remove_active_fervor = fervor_trade
		add_active_fervor = fervor_trade_buffed
	}
	if = {
		limit = { has_active_fervor = fervor_war }
		remove_active_fervor = fervor_war
		add_active_fervor = fervor_war_buffed
	}
	if = {
		limit = { has_active_fervor = fervor_stability }
		remove_active_fervor = fervor_stability
		add_active_fervor = fervor_stability_buffed
	}
	if = {
		limit = { has_active_fervor = fervor_diplomacy }
		remove_active_fervor = fervor_diplomacy
		add_active_fervor = fervor_diplomacy_buffed
	}
}

yua_examination_system_effect = {
	country_event_with_effect_insight = {
		id = flavor_mng.30
		effect = "
			700 = { add_province_triggered_modifier = mng_hanlin_academy_modifier }
			if = {
				limit = { has_dlc = \"Mandate of Heaven\" } 
				add_splendor = 100 
			}
			else = { add_prestige_or_monarch_power = { amount = 25 } }
		"
	}
}

yua_mutual_trade_effect_1 = {
	if = {
		limit = {
			has_dlc = "Mandate of Heaven" 
			is_emperor_of_china = yes 
		}
		custom_tooltip = mng_5_mandate_per_ally_tt
	}
	else = { custom_tooltip = mng_25_mp_per_ally_tt } 
	custom_tooltip = SEPERATOR_TOOLTIP
	add_country_modifier = {
		name = mng_foreign_merchant_influx_modifier
		duration = 7300 
	}
	custom_tooltip = YUA_ALL_ALLIES_THAT_MEET_REQUIREMENTS_GAIN_THE_FOLLOWING
	tooltip = {
		add_country_modifier = {
			name = mng_trade_access_in_china_modifier
			duration = -1 
			desc = as_long_as_we_stay_allies_desc
		}
	}
	hidden_effect = {
		if = {
			limit = { 
				calc_true_if = {
					all_ally = {
						has_opinion = {
							who = ROOT 
							value = 150 
						}
						if = {
							limit = { has_dlc = "Leviathan" }
							trust = {
								who = ROOT 
								value = 70 
							}
						}
					}
					amount = 4 
				}
			}
			every_ally = { 
				limit = { 
					has_opinion = {
						who = ROOT 
						value = 150 
					}
					if = {
						limit = { has_dlc = "Leviathan" }
						trust = {
							who = ROOT 
							value = 70 
						}
					}
				}
				add_country_modifier = {
					name = mng_trade_access_in_china_modifier
					duration = -1 
					desc = as_long_as_we_stay_allies_desc
				}
			}
			add_country_modifier = {
				name = mng_foreign_merchant_influx_modifier
				duration = 7300 
			}
			if = {
				limit = { has_dlc = "Mandate of Heaven" } 
				every_ally = { 
					limit = { 
						has_opinion = {
							who = ROOT 
							value = 150 
						}
						if = {
							limit = { has_dlc = "Leviathan" }
							trust = {
								who = ROOT 
								value = 70 
							}
						}
					}
					ROOT = { add_mandate = 5 } 
				}
			}
			else = { 
				every_ally = { 
					limit = { 
						has_opinion = {
							who = ROOT 
							value = 150 
						}
						if = {
							limit = { has_dlc = "Leviathan" }
							trust = {
								who = ROOT 
								value = 70 
							}
						}
					}
					ROOT = { 
						add_adm_power = 25 
						add_dip_power = 25 
						add_mil_power = 25 
					}
				}
			}
		}
	}
}

yua_single_whip_law_effect = {
	2139 = {
		change_trade_goods = gold 
	}
	
	every_owned_province = { 
		limit = { trade_goods = gold } 
		add_province_modifier = {
			name = mng_silver_house_of_china_modifier
			duration = -1 
		}
	}
	
	define_advisor = { 
		name = "Zhang Juzheng" 
		type = treasurer 
		skill = 2 
		cost_multiplier = 0.2
	}
	
	if = { 
		limit = { 
			any_ally = {
				capital_scope = { continent = europe } 
				OR = {
					any_owned_province = {
						NOT = { continent = europe } 
						trade_goods = gold 
					}
					any_subject_country = { 
						any_owned_province = {
							NOT = { continent = europe } 
							trade_goods = gold 
						}
					}
				}
			}
		}
		random_ally = {
			limit = {
				capital_scope = { continent = europe } 
				OR = {
					any_owned_province = {
						NOT = { continent = europe } 
						trade_goods = gold 
					}
					any_subject_country = { 
						any_owned_province = {
							NOT = { continent = europe } 
							trade_goods = gold 
						}
					}
				}
			}
			add_country_modifier = {
				name = mng_silver_trade_china_modifier 
				duration = 7300 
			}
		}
	}
	
	if = { 
		limit = { has_dlc = "Leviathan" } 
		custom_tooltip = mng_inform_about_potosi_tt
	}
	
	custom_tooltip = mng_may_enact_single_whip_reform
	custom_tooltip = empty_line_tt
	if = { 
		limit = { 
			NOT = { has_estate_privilege = estate_eunuchs_single_whip_law_privilege } 
		}
		set_estate_privilege = estate_eunuchs_single_whip_law_privilege
	}
}